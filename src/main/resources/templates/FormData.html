<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<title>Adminty - Premium Admin Template by Colorlib</title>


<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="description" content="#">
<meta name="keywords"
	content="Admin , Responsive, Landing, Bootstrap, App, Template, Mobile, iOS, Android, apple, creative app">
<meta name="author" content="#">

<link rel="icon" href="../files/assets/images/favicon.ico"
	type="image/x-icon">

<link
	href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,800"
	rel="stylesheet">

<link rel="stylesheet" type="text/css"
	th:href="@{../files/bower_components/bootstrap/dist/css/bootstrap.min.css}">

<link rel="stylesheet" type="text/css"
	th:href="@{../files/bower_components/datatables.net-bs4/css/dataTables.bootstrap4.min.css}">
<link rel="stylesheet" type="text/css"
	th:href="@{../files/bower_components/datatables.net-responsive-bs4/css/responsive.bootstrap4.min.css}">

<link
	th:href="@{../files/assets/pages/jquery.filer/css/jquery.filer.css}"
	type="text/css" rel="stylesheet" />
<link
	th:href="@{../files/assets/pages/jquery.filer/css/themes/jquery.filer-dragdropbox-theme.css}"
	type="text/css" rel="stylesheet" />

<link rel="stylesheet" type="text/css"
	th:href="@{../files/assets/css/component.css}">

<link rel="stylesheet" type="text/css"
	th:href="@{../files/assets/icon/themify-icons/themify-icons.css}">

<link rel="stylesheet" type="text/css"
	th:href="@{../files/assets/icon/icofont/css/icofont.css}">

<link rel="stylesheet" type="text/css"
	th:href="@{../files/assets/icon/feather/css/feather.css}">

<link rel="stylesheet" type="text/css"
	th:href="@{../files/assets/css/style.css}">
<link rel="stylesheet" type="text/css"
	th:href="@{../files/assets/css/jquery.mCustomScrollbar.css}">
</head>

<body>

	<div class="theme-loader">
		<div class="ball-scale">
			<div class="contain">
				<div class="ring">
					<div class="frame"></div>
				</div>
				<div class="ring">
					<div class="frame"></div>
				</div>
				<div class="ring">
					<div class="frame"></div>
				</div>
				<div class="ring">
					<div class="frame"></div>
				</div>
				<div class="ring">
					<div class="frame"></div>
				</div>
				<div class="ring">
					<div class="frame"></div>
				</div>
				<div class="ring">
					<div class="frame"></div>
				</div>
				<div class="ring">
					<div class="frame"></div>
				</div>
				<div class="ring">
					<div class="frame"></div>
				</div>
				<div class="ring">
					<div class="frame"></div>
				</div>
			</div>
		</div>
	</div>

	<div id="pcoded" class="pcoded">
		<div class="pcoded-overlay-box"></div>
		<div class="pcoded-container navbar-wrapper">
			<div th:replace="~{header :: header}"></div>
			<div class="pcoded-main-container">
				<div class="pcoded-wrapper">
					<div th:replace="~{side :: sidebar}"></div>
					<div class="pcoded-content">
						<div class="pcoded-inner-content">

							<div class="main-body">
								<div class="page-wrapper">

									<div class="page-header">
										<div class="row align-items-end">
											<div class="col-lg-8">
												<div class="page-header-title">
													<div class="d-inline">
														<h4>Formdata List</h4>
													</div>
												</div>
											</div>
											<div class="col-lg-4">
												<div class="page-header-breadcrumb">
													<ul class="breadcrumb-title">
														<li class="breadcrumb-item" style="float: left;"><a
															href="../admin/home"> <i class="feather icon-home"></i>
														</a></li>
														<li class="breadcrumb-item" style="float: left;"><a
															href="#!">E-Commerce</a></li>
														<li class="breadcrumb-item" style="float: left;"><a
															href="#!">FormData List</a></li>
													</ul>
												</div>
											</div>
										</div>
									</div>
									<div class="page-body">
										<div class="row">
											<div class="col-sm-12">

												<div class="card">
													<div class="card-header">
														<h5>FormData List</h5>

														<button type="button"
															class="btn btn-primary waves-effect waves-light f-right d-inline-block md-trigger"
															data-modal="modal-13">
															<i class="icofont icofont-plus m-r-5"></i> Add Form
														</button>

														<button id="deleteSelectedBtn" class="btn btn-danger"
															onclick="deleteAll()">Delete</button>

													</div>

													<div class="card-block">
														<div class="table-responsive">
															<div class="table-content">
																<div class="project-table">
																	<table id="e-product-list" class="table  ">
																		<thead>
																			<tr>
																				<td><input type="checkbox"
																					onchange="checkAll(this)" id="selectAllCheckbox"></td>

																				<th>SubCategory Name</th>
																				<th>Form Data</th>

																				<th>Action</th>



																			</tr>
																		</thead>
																		<tbody>

																			<tr th:each="formData : ${formDataList}">
																				<td><input type="checkbox"
																					class="category-checkbox"
																					th:data-id="${formData.id}"
																					th:value="'row-' + ${formData.id}"
																					name="selectedIds[]"></td>

																				<td><span
																					th:each="subcategory : ${subcategoryList}"
																					th:if="${subcategory.id == formData.subcategory}"
																					th:text="${subcategory.name}"> </span></td>
																				<td th:text="${formData.checkedBoxes}"></td>





																				<td style="white-space: nowrap"><a
																					class="btn btn-primary btm-sm"
																					th:href="@{'/admin/Formdata/' + ${formData.id} + '/edit'}">Edit</a>
																					<a class="btn btn-danger btm-sm"
																					th:href="@{'/admin/Formdata/' + ${formData.id} + '/delete'}">Delete</a>
																				</td>



																			</tr>

																		</tbody>
																	</table>
																</div>
															</div>
														</div>
													</div>
												</div>

											</div>
										</div>
										<form id="myForm" method="post" action="/admin/Formdata/get">
											<div class="md-modal md-effect-13 addcontact" id="modal-13">
												<div class="md-content">
													<h3 class="f-26">Add Formdata</h3>
													<div>

														<div class="input-group"
															style="display: flex; align-items: center;">
															<select id="categorySelect"
																onchange="loadSubcategories()" class="form-control"
																style="flex: 1; margin-right: 10px;">
																<option value="">Select Category</option>
																<option th:each="category : ${categories}"
																	th:value="${category.id}" th:text="${category.name}">
																</option>


															</select> <select id="subcategorySelect" class="form-control"
																style="flex: 1;">
																<option value="">Select Subcategory</option>

															</select>
														</div>

														<div class="checkbox-container"
															style="border: 1px solid #ccc; padding: 20px; margin-bottom: 20px;">
															<label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Brand"
																style="color: blue; display: inline-block; margin-right: 5px;">
																Brand
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Model"
																style="color: blue; display: inline-block; margin-right: 5px;">
																Model
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Fuel"
																style="color: blue; display: inline-block; margin-right: 3px;">
																Fuel
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Transmission"
																style="color: blue; display: inline-block; margin-right: 3px;">
																Transmission
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Variant"
																style="color: blue; display: inline-block; margin-right: 3px;">
																Variant
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Accessories"
																style="color: blue; display: inline-block; margin-right: 3px;">
																Accessories
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="ContructionStatus"
																style="color: blue; display: inline-block; margin-right: 3px;">
																ContructionStatus
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="EducationalType"
																style="color: blue; display: inline-block; margin-right: 3px;">
																EducationalType
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Facing"
																style="color: blue; display: inline-block; margin-right: 3px;">
																Facing
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Furnshing"
																style="color: blue; display: inline-block; margin-right: 3px;">
																Furnshing
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="ListedBy"
																style="color: blue; display: inline-block; margin-right: 3px;">
																ListedBy
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Position"
																style="color: blue; display: inline-block; margin-right: 3px;">
																Position
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Property"
																style="color: blue; display: inline-block; margin-right: 3px;">
																Property
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="SalaryPeriod"
																style="color: blue; display: inline-block; margin-right: 3px;">
																SalaryPeriod
															</label> <label
																style="display: inline-block; margin-bottom: 10px;">
																<input class="form-checkbox" type="checkbox"
																name="selectedEntities[]" value="Vehicles"
																style="color: blue; display: inline-block; margin-right: 3px;">
																Vehicles
															</label>
														</div>





													</div>


													<div class="text-center">
														<button type="submit" onclick="submitForm(event)"
															class="btn btn-primary waves-effect m-r-20 f-w-600 d-inline-block save_btn"
															style="padding-right: 20px; padding-left: 20px;">Save</button>
														<button type="button"
															class="btn btn-primary waves-effect m-r-20 f-w-600 md-close d-inline-block close_btn"
															style="padding-right: 20px; padding-left: 20px;">Close</button>
													</div>
												</div>
											</div>
									</div>
									<div class="md-overlay"></div>
									</form>

								</div>

							</div>
						</div>

						<div id="styleSelector"></div>
					</div>
				</div>
			</div>
		</div>
	</div>
	</div>



	<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script type="text/javascript"
		src="../files/bower_components/jquery/dist/jquery.min.js"></script>
	<script type="text/javascript"
		src="../files/bower_components/jquery-ui/jquery-ui.min.js"></script>
	<script type="text/javascript"
		src="../files/bower_components/popper.js/dist/umd/popper.min.js"></script>
	<script type="text/javascript"
		src="../files/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

	<script type="text/javascript"
		src="../files/bower_components/jquery-slimscroll/jquery.slimscroll.js"></script>

	<script type="text/javascript"
		src="../files/bower_components/modernizr/modernizr.js"></script>
	<script type="text/javascript"
		src="../files/bower_components/modernizr/feature-detects/css-scrollbars.js"></script>

	<script
		src="../files/bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
	<script
		src="../files/assets/pages/data-table/js/dataTables.bootstrap4.min.js"></script>
	<script
		src="../files/bower_components/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
	<script
		src="../files/bower_components/datatables.net-responsive-bs4/js/responsive.bootstrap4.min.js"></script>

	<script src="../files/assets/pages/jquery.filer/js/jquery.filer.min.js"></script>
	<script src="../files/assets/pages/filer/custom-filer.js"
		type="text/javascript"></script>
	<script src="../files/assets/pages/filer/jquery.fileuploads.init.js"
		type="text/javascript"></script>

	<script src="../files/assets/js/classie.js"></script>
	<script src="../files/assets/js/modalEffects.js"></script>

	<script type="text/javascript"
		src="../files/assets/pages/product-list/product-list.js"></script>

	<script type="text/javascript"
		src="../files/bower_components/i18next/i18next.min.js"></script>

	<script type="text/javascript"
		src="../files/bower_components/i18next-xhr-backend/i18nextXHRBackend.min.js"></script>
	<script type="text/javascript"
		src="../files/bower_components/i18next-browser-languagedetector/i18nextBrowserLanguageDetector.min.js"></script>
	<script type="text/javascript"
		src="../files/bower_components/jquery-i18next/jquery-i18next.min.js"></script>
	<script src="../files/assets/js/pcoded.min.js"></script>
	<script src="../files/assets/js/vartical-layout.min.js"></script>
	<script src="../files/assets/js/jquery.mCustomScrollbar.concat.min.js"></script>

	<script type="text/javascript" src="../files/assets/js/script.js"></script>


	<script th:inline="javascript">
function loadSubcategories() {
    var categoryId = document.getElementById("categorySelect").value;
    if (categoryId !== "") {
        fetch('/admin/Formdata/api/subcategories/' + categoryId)
            .then(response => response.json())
            .then(data => {
                var subcategorySelect = document.getElementById("subcategorySelect");
                subcategorySelect.innerHTML = '<option value="">Select Subcategory</option>';
                data.forEach(function(subcategory) {
                    subcategorySelect.innerHTML += '<option value="' + subcategory.id + '">' + subcategory.name + '</option>';
                });
            })
            .catch(error => console.error('Error fetching subcategories:', error));
    } else {
      
        document.getElementById("subcategorySelect").innerHTML = '<option value="">Select Subcategory</option>';
    }
}
</script>
	<script th:inline="javascript">
function submitForm(event) {
    event.preventDefault(); 

    var category = document.getElementById("categorySelect").value;
    var subcategory = document.getElementById("subcategorySelect").value;


    
    var checkedBoxes = [];
    var checkboxes = document.querySelectorAll('.form-checkbox:checked');
    checkboxes.forEach(function(checkbox) {
        checkedBoxes.push(checkbox.value);
    })

   
    var formData = {
        category: parseInt(category),
        subcategory: parseInt(subcategory), 
        checkedBoxes: checkedBoxes.join(',')
    };

    $.ajax({
        url: '/admin/Formdata/submit-form',
        type: 'POST',
        contentType: 'application/json',
        data: JSON.stringify(formData),
        success: function(data, textStatus, xhr) {
            if (xhr.status === 201) {
                console.log('Form submitted successfully');
                window.location.href = '/admin/Formdata';
            } else {
                console.error('Form submission failed');
            }
        },
        error: function(xhr, textStatus, errorThrown) {
            console.error('Error submitting form:', errorThrown);
        }
    });
}
</script>


	<script th:inline="javascript">
	
	function checkAll(bx) {
		var cbs = document.querySelectorAll(".category-checkbox");
		for (var i = 0; i < cbs.length; i++) {
			cbs[i].checked = bx.checked;
		}
	}

	$(document).on("click", ".delete-btn", function() {
    var selectedId = $(this).data("id");
    var confirmed = confirm("Are you sure you want to delete this category?");
    if (confirmed) {
        deleteAll(); 
    }
});

function deleteAll() {
    let selectedIds = [];
    $(".category-checkbox:checked").each(function() {
        console.log($(this).data("id"));
        let id = $(this).data("id");
        selectedIds.push(id);
    });
    console.log(selectedIds);
    $.ajax({
        url: "/admin/Formdata/deleteSelected",
        type: "GET",
        traditional: true,
        data: {
            selectedIds: selectedIds 
        },
        success: function(response) {
            console.log("Deletion successful:");
            location.reload();
        },
        error: function(xhr, status, error) {
            console.error("Error occurred during deletion:", error);
        }
    });
}
	


	</script>
</body>



</html>
